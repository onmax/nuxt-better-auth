---
title: NuxtHub
description: Automatic database setup with schema generation and Drizzle ORM integration.
---

NuxtHub provides the easiest way to add database persistence to your authentication. Enable NuxtHub and this module generates and manages your database schema.

::note
NuxtHub is vendor-agnostic. Deploy to Cloudflare, Vercel, or self-host. See [NuxtHub deployment docs](https://hub.nuxt.com/docs/getting-started/deploy).
::

## Features

- **Auto Schema Generation** - Tables for users, sessions, accounts created automatically
- **Plugin-Aware** - Schema updates when you add plugins like `twoFactor`, `passkey`
- **Multi-Dialect** - SQLite, PostgreSQL, or MySQL
- **Multi-Cloud** - Deploy to Cloudflare, Vercel, or self-hosted infrastructure
- **Secondary Storage** - Optional KV storage for session caching
- **Zero Config Migrations** - Use `npx nuxt db migrate` for production

## Setup

::steps

### Install NuxtHub

```bash
pnpm add @nuxthub/core
```

### Configure nuxt.config.ts

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  modules: [
    '@nuxthub/core',
    '@onmax/nuxt-better-auth'
  ],

  hub: {
    db: 'sqlite' // 'sqlite' | 'postgresql' | 'mysql'
  }
})
```

### Restart Dev Server

The schema is generated at build time. Restart after configuration changes.

::

## Configuration Examples

### Shorthand

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  hub: {
    db: 'sqlite'
  }
})
```

### Full Configuration

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  hub: {
    db: {
      dialect: 'sqlite',
      // Additional options
    }
  }
})
```

## Database Dialects

Configure your dialect in `hub.db`:

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  hub: {
    db: {
      dialect: 'postgresql' // or 'sqlite', 'mysql'
    }
  }
})
```

## Secondary Storage (KV)

Enable KV storage for faster session lookups:

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  hub: {
    db: 'sqlite',
    kv: true
  },

  betterAuth: {
    secondaryStorage: true
  }
})
```

Sessions are cached in NuxtHub KV, reducing database queries.

## Production Migrations

NuxtHub handles migrations automatically in most deployments. For manual control:

### Manual Migration

If you need to run migrations manually:

```bash
# Generate migrations from schema changes
npx nuxt db generate

# Apply pending migrations
npx nuxt db migrate
```

### CI/CD Integration

Add to your GitHub Actions workflow:

```yaml
- name: Run migrations
  run: npx nuxt db migrate
  env:
    NUXT_HUB_PROJECT_KEY: ${{ secrets.NUXTHUB_PROJECT_KEY }}
```

::callout{icon="i-lucide-book" to="https://hub.nuxt.com/docs/features/database"}
See [NuxtHub Database docs](https://hub.nuxt.com/docs/features/database) for more details.
::

## Schema Generation Details

The module analyzes your `server/auth.config.ts` at build time:

1. **Reads plugins** from your config
2. **Generates Drizzle schema** matching your dialect
3. **Injects into NuxtHub** via `hub:db:schema:extend` hook

::warning
**Restart Required**: After adding/removing plugins that affect database structure, restart the dev server to regenerate the schema.
::

## Accessing the Database

With NuxtHub, you get access to the Drizzle database instance in your server config:

```ts [server/auth.config.ts]
export default defineServerAuth(({ db }) => ({
  // db is the Drizzle instance from NuxtHub
}))
```
