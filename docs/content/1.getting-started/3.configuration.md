---
title: Configuration
description: Configure the module options and your Better Auth server instance.
navigation.icon: i-lucide-settings
---

## Module Configuration

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  modules: ['@onmax/nuxt-better-auth'],
  auth: {
    redirects: {
      login: '/login',
      guest: '/'
    },
  }
})
```

::field-group
  ::field{name="redirects" type="{ login?: string, guest?: string }"}
    Default: `{ login: '/login', guest: '/' }`

    Paths to redirect to when `auth` protection is triggered.
    - `login`: Where to redirect unauthenticated users.
    - `guest`: Where to redirect authenticated users trying to access guest-only pages.
  ::

  ::field{name="secondaryStorage" type="boolean"}
    Default: `false`

    Enable KV as secondary storage for sessions. This significantly improves performance by reducing database hits for session validation.

    **Requirement**: Requires [NuxtHub Integration](/integrations/nuxthub) with `hub: { kv: true }`.
  ::
::

## Server Configuration

Define your authentication logic in `auth.config.ts` (project root), including plugins, providers, and settings.

### defineServerAuth

Use the `defineServerAuth` helper to ensure type safety and access context.

```ts [auth.config.ts]
import { defineServerAuth } from '@onmax/nuxt-better-auth'

export default defineServerAuth(() => {
  return {
    emailAndPassword: {
      enabled: true
    }
  }
})
```

::note
The module automatically injects `secret` and `baseURL`. You don't need to configure these in `defineServerAuth`.
- **Secret**: Reads from `NUXT_BETTER_AUTH_SECRET` or `BETTER_AUTH_SECRET`
- **Base URL**: Reads from `NUXT_PUBLIC_SITE_URL`
::

### Context Options

The `defineServerAuth` callback receives a context object with useful properties:

```ts [auth.config.ts]
import { defineServerAuth } from '@onmax/nuxt-better-auth'
import { drizzleAdapter } from 'better-auth/adapters/drizzle'

export default defineServerAuth(({ db, runtimeConfig }) => ({
  // Access the database connection (when using NuxtHub)
  database: drizzleAdapter(db),

  // Access runtime config if needed
  // someValue: runtimeConfig.customKey,
}))
```

## Base URL Resolution

The module determines the authentication base URL in the following order:

1. `runtimeConfig.public.siteUrl` (Recommended for production)
2. The current request origin (Development fallback)

::note
Always set `NUXT_PUBLIC_SITE_URL` in production to ensure correct redirect URIs for OAuth providers.
::

## Runtime Config

Configure secrets via environment variables (see [Installation](/getting-started/installation#set-environment-variables)).

```ini [.env]
NUXT_BETTER_AUTH_SECRET="your-super-secret-key"
NUXT_PUBLIC_SITE_URL="http://localhost:3000"
```

## For Module Authors

Other Nuxt modules can extend the authentication configuration:

```ts
// In your Nuxt module
export default defineNuxtModule({
  setup(options, nuxt) {
    nuxt.hook('better-auth:config:extend', (config) => {
      config.plugins = [...(config.plugins || []), myPlugin()]
    })
  }
})
```

Access sessions from server handlers:

```ts
const { user, session } = await getUserSession(event)
if (!user) throw createError({ statusCode: 401 })
```

::callout{icon="i-lucide-arrow-right" to="/getting-started/client-setup"}
Next, set up the **Client Configuration**.
::
