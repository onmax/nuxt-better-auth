---
title: Roleâ€‘Based Access
description: Protect routes using generic field matching on AuthUser.
---

## With Admin Plugin

```ts
// server/auth.config.ts  
import { admin } from 'better-auth/plugins'
export default defineServerAuth(() => ({ plugins: [admin()] }))

// nuxt.config.ts - role is now typed!
routeRules: {
  '/admin/**': { auth: { user: { role: 'admin' } } },
  '/staff/**': { auth: { user: { role: ['admin', 'moderator'] } } },
}
```

## With Organization Plugin

```ts
// Works the same way with any plugin fields
routeRules: {
  '/team/**': { auth: { user: { teamRole: 'owner' } } },
}
```

## With Custom Fields

```ts
// Any field on AuthUser works
routeRules: {
  '/premium/**': { auth: { user: { isPremium: true } } },
  '/verified/**': { auth: { user: { emailVerified: true } } },
}
```

## Matching Logic

- **Single value**: exact match required
- **Array**: OR logic (user field must be one of the values)
- **Multiple fields**: AND logic (all must match)

```ts
// Must be admin AND verified
{ auth: { user: { role: 'admin', emailVerified: true } } }

// Must be admin OR moderator
{ auth: { user: { role: ['admin', 'moderator'] } } }
```

## Complex Logic

For complex authorization, use custom middleware or `requireUserSession` with a `rule` callback.
